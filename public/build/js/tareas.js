!function(){let t=document.querySelector("#todas"),e=document.querySelector("#completadas"),a=document.querySelector("#pendientes");!async function(){try{const t="/api/tareas?id="+l(),e=await fetch(t),a=await e.json();n=a.tareas,s(),c()}catch(t){console.log(t)}}();let n=[],o=[],r=[];document.getElementById("agregar-tarea").addEventListener("click",(function(){i()}));function c(){!function(){const t=document.getElementById("listado-tareas");for(;t.firstChild;)t.removeChild(t.firstChild)}();let a=[];if(a=t.checked?n:e.checked?o:r,0===a.length){const t=document.getElementById("listado-tareas"),e=document.createElement("LI");e.textContent="Parece Que No Tienes Tareas Para Este Proyecto. Crea Una Nueva!",e.classList.add("no-tareas"),t.appendChild(e)}else a.forEach(t=>{const e={0:"Pendiente",1:"Completado"},a=document.createElement("LI");a.dataset.tareaid=t.id,a.classList.add("tarea");const o=document.createElement("P");o.textContent=t.nombre,o.ondblclick=function(){i(!0,{...t})};const r=document.createElement("DIV");r.classList.add("opciones");const m=document.createElement("BUTTON");m.classList.add("estado-tarea"),m.classList.add(""+e[t.estado].toLowerCase()),m.textContent=e[t.estado],m.dataset.estadoTarea=t.estado,m.ondblclick=function(){!function(t){const e="1"===t.estado?"0":"1";t.estado=e,d(t)}({...t})};const u=document.createElement("BUTTON");u.classList.add("eliminar-tarea"),u.dataset.idTarea=t.id,u.textContent="Eliminar",u.ondblclick=function(){!function(t){Swal.fire({title:"Estas Seguro de Eliminar Esta Tarea?",text:"No Podras Revertir Esta Acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminar",cancelButtonText:"No, Cancelar"}).then(e=>{e.isConfirmed&&(Swal.fire("Eliminado!","La Tarea ha sido Eliminada.","success"),async function(t){const{estado:e,id:a,nombre:o}=t,r=new FormData;r.append("id",a),r.append("estado",e),r.append("nombre",o),r.append("url",l());try{const e="http://localhost:3000/api/tarea/eliminar",a=await fetch(e,{method:"POST",body:r});(await a.json()).resultado&&(n=n.filter(e=>e.id!==t.id),s(),c())}catch(t){console.log(t)}}(t))})}({...t})},r.appendChild(m),r.appendChild(u),a.appendChild(o),a.appendChild(r);document.getElementById("listado-tareas").appendChild(a)})}function i(t=!1,e={}){const a=document.createElement("DIV");a.classList.add("modal"),a.innerHTML=`\n\t\t\t<form class="formulario nueva-tarea">\n\t\t\t\t<legend>${t?"Editar Tarea":"Agrega una Nueva Tarea"}</legend>\n\t\t\t\t<div class="campo">\n\t\t\t\t\t<label>Tarea</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="tarea"\n\t\t\t\t\t\tplaceholder='${e.nombre?"Editar Tarea":"Añadir Tarea al Proyecto Actual"}'\n\t\t\t\t\t\tid="tarea"\n\t\t\t\t\t\tvalue = '${e.nombre?e.nombre:""}'\n\t\t\t\t\t/>\n\t\t\t\t</div>\t\n\t\t\t\t<div class="opciones">\n\t\t\t\t\t<input \n\t\t\t\t\t\ttype="submit" \n\t\t\t\t\t\tclass="submit-nueva-tarea" \n\t\t\t\t\t\tvalue='${e.nombre?"Guardar Cambios":"Crear Tarea"}'\n\t\t\t\t\t/>\n\t\t\t\t\t<button type="button" class="cerrar-modal">Cancelar</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t`,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),a.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{a.remove()},500)}if(o.target.classList.contains("submit-nueva-tarea")){const a=document.getElementById("tarea").value.trim(),o=document.querySelector(".formulario legend");if(""===e){const t="El Titulo es Obligatorio";return function(t,e){t.forEach(t=>{e===t.textContent&&t.remove()})}(document.querySelectorAll("form .alerta"),t),void function(t,e,a){const n=document.createElement("DIV");n.classList.add("alerta",e),n.textContent=t,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove()},5e3)}(t,"error",o)}t?(e.nombre=a,d(e)):async function(t){const e=new FormData;e.append("nombre",t);const a=l();e.append("url",a);try{const a="http://localhost:3000/api/tarea",o=await fetch(a,{method:"POST",body:e}),r=await o.json();if("exito"===r.tipo){Swal.fire(r.tipo,r.mensaje,"success");const e=document.querySelector(".modal");e&&e.remove();const a={id:String(r.id),nombre:t,estado:"0",proyectoid:r.proyectoid};n=[...n,a],s(),c()}}catch(t){console.log(t)}}(a)}})),document.querySelector(".dashboard").appendChild(a)}async function d(t){const{estado:e,id:a,nombre:o}=t,r=new FormData;r.append("id",a),r.append("estado",e),r.append("nombre",o),r.append("url",l());try{const t="http://localhost:3000/api/tarea/actualizar",i=await fetch(t,{method:"POST",body:r}),d=await i.json();if("exito"===d.respuesta.tipo){Swal.fire(d.respuesta.tipo,d.respuesta.mensaje,"success");const t=document.querySelector(".modal");t&&t.remove(),n=n.map(t=>(t.id===a&&(t.estado=e,t.nombre=o),t)),s(),c()}}catch(t){console.log(t)}}function s(){o=n.filter(t=>"1"===t.estado),o.length?e.disabled=!1:e.disabled=!0,r=n.filter(t=>"0"===t.estado),r.length?a.disabled=!1:a.disabled=!0}function l(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}document.querySelectorAll('#filtros input[type="radio"]').forEach(t=>{t.addEventListener("input",c)})}();