!function(){!async function(){try{const a="/api/tareas?id="+o(),n=await fetch(a),r=await n.json();t=r.tareas,e()}catch(t){console.log(t)}}();let t=[];function e(){if(function(){const t=document.getElementById("listado-tareas");for(;t.firstChild;)t.removeChild(t.firstChild)}(),0===t.length){const t=document.getElementById("listado-tareas"),e=document.createElement("LI");e.textContent="Parece Que No Tienes Tareas Para Este Proyecto. Crea Una Nueva!",e.classList.add("no-tareas"),t.appendChild(e)}else t.forEach(r=>{const c={0:"Pendiente",1:"Completado"},i=document.createElement("LI");i.dataset.tareaid=r.id,i.classList.add("tarea");const s=document.createElement("P");s.textContent=r.nombre;const d=document.createElement("DIV");d.classList.add("opciones");const l=document.createElement("BUTTON");l.classList.add("estado-tarea"),l.classList.add(""+c[r.estado].toLowerCase()),l.textContent=c[r.estado],l.dataset.estadoTarea=r.estado,l.ondblclick=function(){!function(r){const c="1"===r.estado?"0":"1";r.estado=c,async function(r){const{estado:c,id:i,nombre:s}=r,d=new FormData;d.append("id",i),d.append("estado",c),d.append("nombre",s),d.append("url",o());try{const o="http://localhost:3000/api/tarea/actualizar",r=await fetch(o,{method:"POST",body:d}),s=await r.json();if("exito"===s.respuesta.tipo){a(document.querySelectorAll(".alerta"),s.respuesta.mensaje),n(s.respuesta.mensaje,s.respuesta.tipo,document.querySelector(".contenedor-nueva-tarea")),t=t.map(t=>(t.id===i&&(t.estado=c),t)),e()}}catch(t){console.log(t)}}(r)}({...r})};const m=document.createElement("BUTTON");m.classList.add("eliminar-tarea"),m.dataset.idTarea=r.id,m.textContent="Eliminar",m.ondblclick=function(){!function(a){Swal.fire({title:"Estas Seguro de Eliminar Esta Tarea?",text:"No Podras Revertir Esta Acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminar",cancelButtonText:"No, Cancelar"}).then(n=>{n.isConfirmed&&(Swal.fire("Eliminado!","La Tarea ha sido Eliminada.","success"),async function(a){const{estado:n,id:r,nombre:c}=a,i=new FormData;i.append("id",r),i.append("estado",n),i.append("nombre",c),i.append("url",o());try{const n="http://localhost:3000/api/tarea/eliminar",o=await fetch(n,{method:"POST",body:i});(await o.json()).resultado&&(t=t.filter(t=>t.id!==a.id),e())}catch(t){console.log(t)}}(a))})}({...r})},d.appendChild(l),d.appendChild(m),i.appendChild(s),i.appendChild(d);document.getElementById("listado-tareas").appendChild(i)})}function a(t,e){t.forEach(t=>{e===t.textContent&&t.remove()})}function n(t,e,a){const n=document.createElement("DIV");n.classList.add("alerta",e),n.textContent=t,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove()},5e3)}function o(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}document.getElementById("agregar-tarea").addEventListener("click",(function(){const r=document.createElement("DIV");r.classList.add("modal"),r.innerHTML='\n\t\t\t<form class="formulario nueva-tarea">\n\t\t\t\t<legend>Agrega una Nueva Tarea</legend>\n\t\t\t\t<div class="campo">\n\t\t\t\t\t<label>Tarea</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="tarea"\n\t\t\t\t\t\tplaceholder="Añadir Tarea"\n\t\t\t\t\t\tid="tarea"\n\t\t\t\t\t/>\n\t\t\t\t</div>\t\n\t\t\t\t<div class="opciones">\n\t\t\t\t\t<input type="submit" class="submit-nueva-tarea" value="Añadir Tarea"/>\n\t\t\t\t\t<button type="button" class="cerrar-modal">Cancelar</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t',setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),r.addEventListener("click",(function(c){if(c.preventDefault(),c.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{r.remove()},500)}c.target.classList.contains("submit-nueva-tarea")&&function(){const r=document.getElementById("tarea").value.trim(),c=document.querySelector(".formulario legend");if(""===r){const t="El Titulo es Obligatorio";return a(document.querySelectorAll("form .alerta"),t),void n(t,"error",c)}!async function(a){const r=new FormData;r.append("nombre",a);const c=o();r.append("url",c);try{const o="http://localhost:3000/api/tarea",c=await fetch(o,{method:"POST",body:r}),i=await c.json(),s=document.querySelector(".formulario legend");if(n(i.mensaje,i.tipo,s),"exito"===i.tipo){const n=document.querySelector(".modal");setTimeout(()=>{n.remove()},3e3);const o={id:String(i.id),nombre:a,estado:"0",proyectoid:i.proyectoid};t=[...t,o],e()}}catch(t){console.log(t)}}(r)}()})),document.querySelector(".dashboard").appendChild(r)}))}();